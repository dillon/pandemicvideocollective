<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>pandemicvideocollective.com</title>
  <meta property="og:title" content="Pandemic Video Collective" />
  <meta name="description" content="pandemicvideocollective.com" />
  <meta property="og:description" content="pandemicvideocollective.com" />
  <link rel="icon" type="image/png" href="alarm.png" />
  <meta property="og:image" content="alarm.png" />
  <link rel="stylesheet" type="text/css" href="main.css">
</head>
<body>
  <header id="header">
    <button id="mainTitleButton" onclick="playVideo()" type="button" aria-label="hide header and play video">
      <h1 id="mainTitle">
      </h1>
    </button> 
  </header>
  <video 
    id="videoElement" 
    width="100%" 
    height="100%"
    controls
  >
  </video>
  <script> 
    const header = document.getElementById("header"); 
    const videoElement = document.getElementById("videoElement"); 
    const mainTitle = document.getElementById("mainTitle")
    const mainTitleButton = document.getElementById('mainTitleButton')
    const arrowsArray = [
      "&#10228;",
      "&#10513;",
      "&#10567;",
      "&#10143;",
      "&#10522;",
      "&#10565;",
      "&#10154;",
      "&#10509;",
      "&#10583;",
      "&#10230;",
      "&#10518;",
      "&#10170;",
      "&#10610;",
      "&#10171;",
      "&#10233;",
      "&#10609;",
    ]
    let userHasTouched = false
    
    function playVideo() {
      videoElement.play(); 
      header.classList.add("hide")
    }
    function fetchDataAndInsert() {
      fetch("https://spreadsheets.google.com/feeds/cells/1f5pZ78q3jUERJ3YGQfv2RFqjIx8VGuDQJhQD2wvU1ZQ/1/public/full?alt=json")
        .catch(x => console.log(x))
        .then(x => x.json())
        .then(theData => {
          if (!(theData && theData.feed && theData.feed.entry && theData.feed.entry.length > 0)) {
            mainTitleButton.style.cursor = 'default'
            mainTitleButton.onclick = null
            mainTitle.innerHTML = "Week 0"
          } else {
          const rows = theData.feed.entry;
          const rowLength = rows && rows.length
          const chosenArrow = arrowsArray[(rowLength - 1) % arrowsArray.length]
          let url = theData.feed.entry.slice(-1)[0].content['$t']
            .replace("www.dropbox", "dl.dropboxusercontent")
            .replace("dl=0", "dl=1")
          
          mainTitle.innerHTML = "Week " + rowLength + ' ' + chosenArrow
          const videoSourceElement = document.createElement('source');
          
          videoSourceElement.src = url;
          videoSourceElement.type = "video/mp4";
          videoElement.appendChild(videoSourceElement)
          }
        })
    }
    window.ontouchstart = function() {
      if (!userHasTouched) {
        userHasTouched = true
        playVideo();
      }
    }
    window.onload = fetchDataAndInsert
    </script> 
</body>
</html>

&#8669;
